@extends('layouts.masterGermac')

<title>Liste des exploiatations </title>

@section('content')
    <div class="card">

        <h4 class="card-header">Liste des exploitations du matériel '{{$select_mat}}' :&nbsp;
            <a href="{{ Route('Exploitations.create',['select_mat'=> $select_mat]) }} "  class="btn btn-primary " >
                <i class="fa fa-plus"></i> Ajouter une exploitation
            </a>&nbsp;&nbsp;&nbsp;
            {{-- bouton de retour
            <a href="{{ route('homeGT') }}"  class="btn btn-outline-info" >
                <i class="fa fa-arrow-left"></i> Retour à l'accueil
            </a>
            --}}
        </h4>
        @if ($listExp->isEmpty())
            <h4 class="text-center text-warning">Ce matériel n'a aucune exploitation enregistrée. &nbsp;  </h4>
        @else

            @php
            if (($materiel->idgrpe == 2) or ($materiel->idgrpe == 3)){
            $unite = 'Heures';
            }else $unite = 'Kilomètres';
            @endphp

            {{-- $unite --}}

            <div class="dataTable ">
                <table id="zero_config" class="table table-sm text-center">

                    <thead class="thead-light">
                    <tr>

                        <th> Motif exploitation </th>
                        <th> Demandeur </th>
                        <th> Date  </th>
                        <th> Ravitaillement </th>
                        <th> Valeur tableau de bord </th>
                        <th> </th>

                    </tr>
                    </thead>
                    <tbody class="text-center">
                @foreach($listExp as $exp)
                    <tr>
                        <td> {{  $exp->motif_exploit  }}</td>
                        @php
                        $dd = new App\Demandeur;
                            $demandeur = $dd->where('id',$exp->demandeur_id)->first();
                            $nomDemandeur = $demandeur->nom_demandeur;
                        @endphp
                        <td> {{   $nomDemandeur  }}</td>
                        <td> {{   $exp->date_exploit   }}</td>
                        <td> {{  $exp->qtite_ravitaillement }}</td>
                        <td > {{  $exp->releve_tableau.' '.$unite }}</td>


                        <td>
                            <a href="{{Route('Exploitations.edit',$exp)}}" class="btn btn-primary btn-sm">Modifier</a>


                            <form action="{{ Route('Exploitations.destroy',$exp) }}"
                                  method="post"
                                  class="d-inline-block"
                                  onclick="return confirm('Voulez-vous vraiment supprimer cette exploitation ?')">
                                {{csrf_field()}}
                                {{method_field('DELETE')}}
                                <input type="submit" class=" btn btn-danger btn-sm" value="Supprimer"  />
                                <input type="hidden" name='idExp' value="{{ $exp->id }}" />
                            </form>
                        </td>

                    </tr>


                @endforeach

                    </tbody>
                </table>
            </div>
        @endif

    </div>
@endsection